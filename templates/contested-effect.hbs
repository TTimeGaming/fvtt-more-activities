<section class="tab activity-{{ tab.id }} {{ tab.cssClass }}" data-tab="{{ tab.id }}" data-group="{{ tab.group }}">
    <fieldset>
        <legend><label> Configuration </label></legend>

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.tieCondition.label"}}</label>
            <div class="form-fields">
                <select name="tieCondition">
                    {{#each tieConditionOptions as |option|}}
                    <option value="{{ option.value }}" {{#if (eq ../tieCondition option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                </select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.tieCondition.hint"}}</p>
        </div>

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.allowPlayerTargeting.label"}}</label>
            <div class="form-fields">
                <dnd5e-checkbox name="allowPlayerTargeting" {{#if allowPlayerTargeting}}checked{{/if}}></dnd5e-checkbox>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.allowPlayerTargeting.hint"}}</p>
        </div>
    </fieldset>

    <fieldset>
        <legend><label> Degrees of Success </label></legend>

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.allowMinorSuccess.label"}}</label>
            <div class="form-fields">
                <dnd5e-checkbox name="allowMinorSuccess" {{#if allowMinorSuccess}}checked{{/if}}></dnd5e-checkbox>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.allowMinorSuccess.hint"}}</p>
        </div>

        {{#if allowMinorSuccess}}
        <div class="form-group stacked indented">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.thresholdMinorSuccess.label"}}</label>
            <div class="form-fields">
                <input type="number" name="thresholdMinorSuccess" value="{{ thresholdMinorSuccess }}" min="1" max="20">
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.thresholdMinorSuccess.hint"}}</p>
        </div>
        {{/if}}

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.allowMajorSuccess.label"}}</label>
            <div class="form-fields">
                <dnd5e-checkbox name="allowMajorSuccess" {{#if allowMajorSuccess}}checked{{/if}}></dnd5e-checkbox>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.allowMajorSuccess.hint"}}</p>
        </div>

        {{#if allowMajorSuccess}}
        <div class="form-group stacked indented">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.thresholdMajorSuccess.label"}}</label>
            <div class="form-fields">
                <input type="number" name="thresholdMajorSuccess" value="{{ thresholdMajorSuccess }}" min="1" max="20">
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.thresholdMajorSuccess.hint"}}</p>
        </div>
        {{/if}}
    </fieldset>

    <fieldset>
        <legend><label> Attacker </label></legend>

        <div class="form-group stacked">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.label.label"}}</label>
            <div class="form-fields">
                <input type="text" name="attackerLabel" value="{{ attackerLabel }}" placeholder="Attacker">
            </div>
        </div>

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.rollType.label"}}</label>
            <div class="form-fields">
                <select name="attackerRollType">
                    <option value="ability" {{#if (eq attackerRollType "ability")}}selected{{/if}}>Ability Check</option>
                    <option value="skill" {{#if (eq attackerRollType "skill")}}selected{{/if}}>Skill Check</option>
                    <option value="spellcasting" {{#if (eq attackerRollType "spellcasting")}}selected{{/if}}>Spellcasting</option>
                    <option value="custom" {{#if (eq attackerRollType "custom")}}selected{{/if}}>Custom DC</option>
                </select>
            </div>
        </div>

        {{#if (or (eq attackerRollType "ability") (eq attackerRollType "skill"))}}
        <div class="form-group stacked indented">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.availableOptions.label"}}</label>
            <div class="form-fields">
                <multi-select name="attackerOptions">
                {{#if (eq attackerRollType "ability")}}
                    {{#each rollTypeOptions.ability as |option|}}
                    <option value="{{ option.value }}" {{#if (includes ../attackerOptions option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                {{/if}}
                {{#if (eq attackerRollType "skill")}}
                    {{#each rollTypeOptions.skill as |option|}}
                    <option value="{{ option.value }}" {{#if (includes ../attackerOptions option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                {{/if}}
                </multi-select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.availableOptions.hint"}}</p>
        </div>
        {{/if}}

        {{#if (eq attackerRollType "custom")}}
        <div class="form-group stacked indented">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.customBonus.label"}}</label>
            <div class="form-fields">
                <input type="text" name="attackerCustom" value="{{ attackerCustom }}" placeholder="Custom Bonus">
            </div>
            <p class="hint"><abbr title="{{localize "DND5E.ACTIVITY.FIELDS.contested.rollFormula.label"}}"><i class="fas fa-calculator"></i></abbr>&emsp;{{localize "DND5E.ACTIVITY.FIELDS.contested.customBonus.hint"}}</p>
        </div>
        {{/if}}
    </fieldset>
    </fieldset>

    <fieldset>
        <legend><label> Defender </label></legend>

        <div class="form-group stacked">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.label.label"}}</label>
            <div class="form-fields">
                <input type="text" name="defenderLabel" value="{{ defenderLabel }}" placeholder="Defender">
            </div>
        </div>

        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.rollType.label"}}</label>
            <div class="form-fields">
                <select name="defenderRollType">
                    <option value="ability" {{#if (eq defenderRollType "ability")}}selected{{/if}}>Ability Check</option>
                    <option value="skill" {{#if (eq defenderRollType "skill")}}selected{{/if}}>Skill Check</option>
                    <option value="spellcasting" {{#if (eq defenderRollType "spellcasting")}}selected{{/if}}>Spellcasting</option>
                </select>
            </div>
        </div>

        {{#if (or (eq defenderRollType "ability") (eq defenderRollType "skill"))}}
        <div class="form-group stacked indented">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.availableOptions.label"}}</label>
            <div class="form-fields">
                <multi-select name="defenderOptions">
                    {{#if (eq defenderRollType "ability")}}
                    {{#each rollTypeOptions.ability as |option|}}
                    <option value="{{ option.value }}" {{#if (includes ../defenderOptions option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                {{/if}}
                {{#if (eq defenderRollType "skill")}}
                    {{#each rollTypeOptions.skill as |option|}}
                    <option value="{{ option.value }}" {{#if (includes ../defenderOptions option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                {{/if}}
                </multi-select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.availableOptions.hint"}}</p>
        </div>
        {{/if}}
    </fieldset>

    <fieldset>
        <legend><label> Effects </label></legend>
        
        <div class="form-group">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.applyEffectsTo.label"}}</label>
            <div class="form-fields">
                <select name="applyEffectsTo">
                    {{#each applyEffectsToOptions as |option|}}
                    <option value="{{ option.value }}" {{#if (eq ../applyEffectsTo option.value)}}selected{{/if}}>
                        {{ option.label }}
                    </option>
                    {{/each}}
                </select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.applyEffectsTo.hint"}}</p>
        </div>

        <div class="form-group stacked">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffects.label"}}</label>
            <div class="form-fields">
                <multi-select name="appliedEffects">
                    {{#each availableEffects as |effect|}}
                    <option value="{{ effect.id }}" {{#if (includes ../appliedEffects effect.id)}}selected{{/if}}>
                        {{ effect.name }}
                    </option>
                    {{/each}}
                </multi-select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffects.hint"}}</p>
        </div>

        {{#if allowMinorSuccess}}
        <div class="form-group stacked">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffectsMinor.label"}}</label>
            <div class="form-fields">
                <multi-select name="appliedEffectsMinor">
                    {{#each availableEffects as |effect|}}
                    <option value="{{ effect.id }}" {{#if (includes ../appliedEffectsMinor effect.id)}}selected{{/if}}>
                        {{ effect.name }}
                    </option>
                    {{/each}}
                </multi-select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffectsMinor.hint"}}</p>
        </div>
        {{/if}}

        {{#if allowMajorSuccess}}
        <div class="form-group stacked">
            <label>{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffectsMajor.label"}}</label>
            <div class="form-fields">
                <multi-select name="appliedEffectsMajor">
                    {{#each availableEffects as |effect|}}
                    <option value="{{ effect.id }}" {{#if (includes ../appliedEffectsMajor effect.id)}}selected{{/if}}>
                        {{ effect.name }}
                    </option>
                    {{/each}}
                </multi-select>
            </div>
            <p class="hint">{{localize "DND5E.ACTIVITY.FIELDS.contested.appliedEffectsMajor.hint"}}</p>
        </div>      
        {{/if}}
    </fieldset>
</section>
