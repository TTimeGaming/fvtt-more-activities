<div class="dnd5e2 chat-card activation-card">
    <section class="card-header description collapsible">
        <header class="summary">
            <img class="gold-icon" src="{{ item.img }}" alt="{{ item.name }}">
            <div class="name-stacked border">
                <span class="title">{{ item.name }}</span>
                <span class="subtitle">{{localize "DND5E.ACTIVITY.MESSAGE.contested.subtitle"}}</span>
            </div>
        </header>
    </section>

    <div class="card-content">
        <div class="contested-check">
            <!-- Attacker Section -->
            <div class="contest-side attacker-side">
                <h4>{{ attackerLabel }}</h4>
                
                {{#if attackerRoll}}
                    <div class="roll-result">
                        <div class="dice-total">{{ attackerRoll.total }}</div>
                    </div>
                {{else}}
                    <div class="roll-buttons">
                        {{#each attackerOptions as |option|}}
                        <button class="contested-roll-button" data-side="attacker" data-option="{{ option.key }}">
                            {{ option.label }}
                        </button>
                        {{/each}}
                    </div>
                {{/if}}
            </div>

            <!-- Defender Section -->
            <div class="contest-side defender-side">
                <h4>{{ defenderLabel }}</h4>
                
                {{#if defenderRoll}}
                    <div class="roll-result">
                        <div class="dice-total">{{ defenderRoll.total }}</div>
                    </div>
                {{else}}
                    <div class="roll-buttons">
                        {{#each defenderOptions as |option|}}
                        <button class="contested-roll-button" data-side="defender" data-option="{{ option.key }}">
                            {{ option.label }}
                        </button>
                        {{/each}}
                    </div>
                {{/if}}
            </div>
        </div>

        <!-- Result Section -->
        {{#if result}}
        <div class="contest-result">
            {{#if (eq result "attacker")}}
                <div class="result-message winner-attacker">
                    <strong>{{localize "DND5E.ACTIVITY.MESSAGE.contested.result.victory" side=attackerLabel}}</strong>
                    ({{ attackerRoll.total }} vs {{ defenderRoll.total }})
                </div>
            {{else if (eq result "defender")}}
                <div class="result-message winner-defender">
                    <strong>{{localize "DND5E.ACTIVITY.MESSAGE.contested.result.victory" side=defenderLabel}}</strong>
                    ({{ defenderRoll.total }} vs {{ attackerRoll.total }})
                </div>
            {{else if (eq result "tie")}}
                <div class="result-message tie">
                    <strong>{{localize "DND5E.ACTIVITY.MESSAGE.contested.result.tie"}}</strong>
                    ({{ attackerRoll.total }} vs {{ defenderRoll.total }})
                </div>
            {{else if (eq result "reroll")}}
                <div class="result-message reroll">
                    <strong>{{localize "DND5E.ACTIVITY.MESSAGE.contested.result.reroll"}}</strong>
                    ({{ attackerRoll.total }} vs {{ defenderRoll.total }})
                </div>
                <button class="contested-reroll-button" data-activity-id="{{ activity.id }}" data-itemid="{{ item.id }}" data-actor-id="{{ actor.id }}">
                    Re-Roll
                </button>
            {{/if}}
        </div>
        {{/if}}
    </div>
</div>
